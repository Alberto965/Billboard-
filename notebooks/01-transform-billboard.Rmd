---
title: "Transform billboard"
output: html_notebook
---

Idea is to transform the data.world billboard data into the same format and headers that I use for the updates using billboard.py. That API doesn't work well with older dates.

Switched to using R because pandas sucks.

A big difference in this data and the data from billboard.py is "peak position" for data.world is as of that week, where billboard it is for future weeks, too, which seems totally bunk.

```{r setup, echo=T, results='hide', message=F, warning=F}
library(tidyverse)
library(janitor)
library(lubridate)
```

## Import the billboard file

```{r import}
billboard <- read_csv("../data/billboard.csv") %>% clean_names()
```

## Transform the data

```{r}
billboard <- billboard %>% 
  select(week_id, song, performer, week_position, previous_week_position, peak_position, weeks_on_chart) %>% 
  rename(
    date = week_id,
    title = song,
    artist = performer,
    current = week_position,
    previous = previous_week_position,
    peak = peak_position,
    weeks = weeks_on_chart
  ) %>% 
  mutate(date = mdy(date))
```

## Import the billboard version

```{r}
hot_100 <- read_csv("../data/hot-100.csv") %>% clean_names()
```


## Testing peak position



```{r}
billboard %>% 
  filter(artist == "Drake") %>% 
  # select(title, artist) %>% 
  arrange(date, title)
```


```{r}
billboard %>% 
  arrange(date, title) %>% 
  filter(
    artist == "Drake",
    title == "Started From The Bottom"
  ) %>% head(10)
```

```{r}
hot_100 %>% 
  arrange(date, title) %>% 
  filter(
    artist == "Drake",
    title == "Started From The Bottom"
  ) %>% head(10)
```

